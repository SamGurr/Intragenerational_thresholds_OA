rel.resp_Days.1.14.final$Date <- as.character(rel.resp_Days.1.14.final$Date)
FIGURE.rel.resp.COUNT.Days1.14 <- ggplot(rel.resp_Days.1.14.final, aes(x=Date, y=rel.resp.COUNT_mean, colour=Treatment, group=Treatment)) +
geom_errorbar(aes(ymin=rel.resp.COUNT_mean-rel.resp.COUNT_std.error,
ymax=rel.resp.COUNT_mean+rel.resp.COUNT_std.error), colour="black", width=.1,position=pd) +
geom_line(position=pd) +
geom_point(position=pd, size=3, shape=21, fill="white") + # 21 is filled circle
xlab("Date") +
ylab("SMR per individual & relative to Ambient") +
scale_colour_hue(name="Supplement type",    # Legend label, use darker colors
breaks=c("AHM", "AHS", "EHM", "EHS"),
labels=c("Amb-Mod", "Amb-Sev", "Elev-Mod", "Elev-Sev"),
l=40) +                    # Use darker colors, lightness=40
ggtitle("Days 1-14 relative metabolic rate") +
expand_limits(y=0) +                        # Expand y range
scale_y_continuous(breaks=0:20*4) +         # Set tick every 4
geom_vline(xintercept = c(3.5), linetype="dotted", color = "black", size=0.5) + # add line between initial exposure nad ambient recovery
theme_bw() +
theme(legend.justification=c(1,1),
legend.position=c(1,1))               # Position legend in bottom right
FIGURE.rel.resp.COUNT.Days1.14  <- FIGURE.rel.resp.COUNT.Days1.14 +  # add text
annotate(geom="text", x=2, y=6, label="Amb v. Mod. v. Sev (n = 6 treatments)", color="black") +
annotate(geom="text", x=5, y=6, label="Ambient recovery", color="black")
FIGURE.rel.resp.COUNT.Days1.14 # view plot # view the plot
# days 15- 21 rel metabolic rate (per individual)
rel.resp_Days.15.21.final$Date <- as.character(rel.resp_Days.15.21.final$Date)
FIGURE.rel.resp.COUNT.Days15.21 <- ggplot(rel.resp_Days.15.21.final, aes(x=Date, y=rel.resp.COUNT_mean, colour=Treatment, group=Treatment)) +
geom_errorbar(aes(ymin=rel.resp.COUNT_mean-rel.resp.COUNT_std.error,
ymax=rel.resp.COUNT_mean+rel.resp.COUNT_std.error), colour="black", width=.1,position=pd) +
geom_line(position=pd) +
geom_point(position=pd, size=3, shape=21, fill="white") + # 21 is filled circle
xlab("Date") +
ylab("SMR per individual & relative to Ambient") +
scale_colour_hue(name="Supplement type",    # Legend label, use darker colors
breaks=c("AHAM", "AHMM", "AHSM", "EHAM", "EHMM", "EHSM"),
labels=c("Amb-Amb-Mod", "Amb-Mod-Mod", "Amb-Sev-Mod",
"Elev-Amb-Mod", "Elev-Mod-Mod", "Elev-Sev-Mod"),
l=40) +                    # Use darker colors, lightness=40
ggtitle("Days 15-21 relative metabolic rate") +
expand_limits(y=0) +                        # Expand y range
scale_y_continuous(breaks=0:20*4) +         # Set tick every 4
theme_bw() +
theme(legend.justification=c(0,1),
legend.position=c(0,1))             # Position legend in bottom right
FIGURE.rel.resp.COUNT.Days15.21  <- FIGURE.rel.resp.COUNT.Days15.21 +  # add text
annotate(geom="text", x=2, y=6, label="Reciprocal Amb v. Mod (n = 12 treatments)", color="black") +
annotate(geom="text", x=1.25, y=4, label="a", color="black") +
annotate(geom="text", x=1.15, y=-0.2, label="ab", color="black") +
annotate(geom="text", x=1.10, y=-0.2, label="ab", color="black") +
annotate(geom="text", x=1, y=-0.2, label="ab", color="black") +
annotate(geom="text", x=0.9, y=-0.2, label="b", color="black") +
annotate(geom="text", x=0.82, y=-0.2, label="ab", color="black") +
annotate(geom="text", x=2.25, y=0.2, label="ab", color="black") +
annotate(geom="text", x=2.15, y=-0.2, label="ab", color="black") +
annotate(geom="text", x=2.1, y=1.8, label="ab", color="black") +
annotate(geom="text", x=2, y=-2.6, label="b", color="black") +
annotate(geom="text", x=1.9, y=0.3, label="ab", color="black") +
annotate(geom="text", x=1.82, y=-0.3, label="ab", color="black") +
annotate(geom="text", x=3.25, y=0.2, label="ab", color="black") +
annotate(geom="text", x=3.15, y=-1.7, label="b", color="black") +
annotate(geom="text", x=3.1, y=-0.7, label="ab", color="black") +
annotate(geom="text", x=3, y=-0.3, label="ab", color="black") +
annotate(geom="text", x=2.9, y=-0.2, label="ab", color="black") +
annotate(geom="text", x=2.82, y=0.6, label="ab", color="black")
FIGURE.rel.resp.COUNT.Days15.21 # view plot # view the plot
# Arrange plots
SMR.relative.plot <- ggarrange(FIGURE.rel.resp.COUNT.Days1.14, FIGURE.rel.resp.COUNT.Days15.21,ncol = 1, nrow = 2) # combine plots
SMR.relative.plot # view plots
names(resp_Days.1.7.final)
pd <- position_dodge(0.25) # dodge between treatments to ease asthetics and interpretation
# FIGURE 1
resp_Days.pre.final$Date <- as.character(resp_Days.pre.final$Date) # call date as a character
FIGURE.resp.pre <- ggplot(resp_Days.pre.final, aes(x=factor(Date), y=resp.COUNT.µg.L.hr.indiv_mean, colour=Treatment.history, group=Treatment.history)) +
geom_errorbar(aes(ymin=resp.COUNT.µg.L.hr.indiv_mean-resp.COUNT.µg.L.hr.indiv_std.error,
ymax=resp.COUNT.µg.L.hr.indiv_mean+resp.COUNT.µg.L.hr.indiv_std.error), width=.1, position=pd) +
geom_line(position=pd) +
theme_bw() +
xlab("Date") +
ylab("SMR per individual") +
scale_colour_hue(name="Treatment",    # Legend label, use darker colors
breaks=c("AHA", "AHM", "AHS", "EHA","EHM", "EHS"),
labels=c("Amb-Amb", "Amb-Mod", "Amb-Sev", "Elev-Amb", "Elev-Mod", "Elev-Sev"), l=40) + # Use darker colors, lightness=40
ggtitle("Pre-experiment SMR") +
geom_point(position=pd, shape=c(21, 24), size=3,fill=("white")) + # 21 is filled circle
#expand_limits(y=0) +                        # Expand y range
ylim(4, 13) +
#scale_y_continuous(breaks=0:20*4) +         # Set tick every 4
theme(legend.justification=c(1,1),
legend.position=c(1,1))               # Position legend in bottom right
FIGURE.resp.pre  <- print(FIGURE.resp.pre + scale_colour_manual(values = c("skyblue1", "tomato1"))+ theme(legend.position = "none"))
# FIGURE 2
# days 1 - 7 rel metabolic rate (per individual) ----------------------------------------------------------------------------------------------- #
resp_Days.1.7.final$Date <- as.character(resp_Days.1.7.final$Date) # call date as a character
FIGURE.resp_Days.1.7 <- ggplot(resp_Days.1.7.final, aes(x=factor(Date), y=resp.COUNT.µg.L.hr.indiv_mean, group=TREATMENT, colour=TREATMENT)) +
geom_errorbar(aes(ymin=resp.COUNT.µg.L.hr.indiv_mean-resp.COUNT.µg.L.hr.indiv_std.error,
ymax=resp.COUNT.µg.L.hr.indiv_mean+resp.COUNT.µg.L.hr.indiv_std.error), width=.3, position=pd) +
geom_line(position=pd, width=.3) +
theme_bw() +
xlab("Date") +
ylab("SMR per individual") +
scale_colour_hue(name="Treatment",    # Legend label, use darker colors
breaks=c("AHA", "AHM", "AHS", "EHA","EHM", "EHS"),
labels=c("Amb-Amb", "Amb-Mod", "Amb-Sev", "Elev-Amb", "Elev-Mod", "Elev-Sev"), l=40) + # Use darker colors, lightness=40
ggtitle("Days 1-7 SMR") +
geom_point(position=pd, shape=c(21, 21, 21, 24, 24, 24,21, 21, 21, 24, 24, 24,21, 21, 21, 24, 24, 24), size=3, fill=("white")) + # 21 is filled circle
#expand_limits(y=0) +
ylim(4, 13) +
#scale_y_continuous(breaks=0:20*4) +         # Set tick every 4
theme(legend.justification=c(1,1),
legend.position=c(1,1))               # Position legend in bottom right
FIGURE.resp_Days.1.7  <- print(FIGURE.resp_Days.1.7 + scale_colour_manual(values = c("skyblue1", "deepskyblue3", "blue", "tomato1", "red1", "firebrick4"))+ theme(legend.position = "none"))
# FIGURE 3
# days 8-14 rel metabolic rate (per individual)----------------------------------------------------------------------------------------------- #
resp_Days.8.14.final$Date <- as.character(resp_Days.8.14.final$Date)
FIGURE.resp_Days.8.14 <- ggplot(resp_Days.8.14.final, aes(x=factor(Date), y=resp.COUNT.µg.L.hr.indiv_mean, colour=TREATMENT, group=TREATMENT)) +
geom_errorbar(aes(ymin=resp.COUNT.µg.L.hr.indiv_mean-resp.COUNT.µg.L.hr.indiv_std.error,
ymax=resp.COUNT.µg.L.hr.indiv_mean+resp.COUNT.µg.L.hr.indiv_std.error), width=.3, position=pd) +
geom_line(position=pd, width=.3) +
theme_bw() +
xlab("Date") +
ylab("SMR per individual") +
scale_colour_hue(name="Treatment",    # Legend label, use darker colors
breaks=c("AHA", "AHM", "AHS", "EHA","EHM", "EHS"),
labels=c("Amb-Amb", "Amb-Mod", "Amb-Sev", "Elev-Amb", "Elev-Mod", "Elev-Sev"), l=40) + # Use darker colors, lightness=40
ggtitle("Days 8-14 SMR") +
geom_point(position=pd, shape=c(21, 21, 21, 24, 24, 24,21, 21, 21, 24, 24, 24,21, 21, 21, 24, 24, 24), size=3, fill=("white")) + # 21 is filled circle
#expand_limits(y=0) +
ylim(4, 13) +
#scale_y_continuous(breaks=0:20*4) +         # Set tick every 4
theme(legend.justification=c(1,1),
legend.position=c(1,1))            # Position legend in bottom right
FIGURE.resp_Days.8.14  <- print(FIGURE.resp_Days.8.14 + scale_colour_manual(values = c("skyblue1", "deepskyblue3", "blue", "tomato1", "red1", "firebrick4"))+ theme(legend.position = "none"))
# FIGURE 4
# days 15-21 rel metabolic rate (per individual)    ----------------------------------------------------------------------------------------------- #
resp_Days.15.21.final$Date <- as.character(resp_Days.15.21.final$Date)
FIGURE.resp_Days.15.21 <- ggplot(resp_Days.15.21.final, aes(x=factor(Date), y=resp.COUNT.µg.L.hr.indiv_mean, colour=TREATMENT, group=TREATMENT, shape = Treatment.EXP_2)) +
geom_errorbar(aes(ymin=resp.COUNT.µg.L.hr.indiv_mean-resp.COUNT.µg.L.hr.indiv_std.error,
ymax=resp.COUNT.µg.L.hr.indiv_mean+resp.COUNT.µg.L.hr.indiv_std.error), width=.3, position=pd) +
geom_line(position=pd, width=.3) +
theme_bw() +
xlab("Date") +
ylab("SMR per individual") +
scale_colour_hue(name="Treatment",    # Legend label, use darker colors
breaks=c("AHAA", "AHAM", "AHMA", "AHMM",
"AHSA","AHSM", "EHAA", "EHAM",
"EHMA", "EHMM", "EHSA", "EHSM"),
labels=c("Amb-Amb-Amb", "Amb-Amb-Mod", "Amb-Mod-Amb", "Amb-Mod-Mod",
"Amb-Sev-Amb", "Amb-Sev-Mod", "Elev-Amb-Amb","Elev-Amb-Mod",
"Elev-Mod-Amb", "Elev-Mod-Mod", "Elev-Sev-Amb", "Elev-Sev-Mod"), l=40) + # Use darker colors, lightness=40
ggtitle("Days 15-21 SMR") +
geom_point(position=pd, shape=c(21, 21, 21, 21, 21, 21, 24, 24, 24, 24, 24, 24,  21, 21, 21, 21, 21, 21,
24, 24, 24, 24, 24, 24, 21, 21, 21, 21, 21, 21,  24, 24, 24, 24, 24, 24), size=3,
fill=c("firebrick4", "white", "red1", "white", "tomato1",
"white", "blue", "white", "deepskyblue3", "white", "skyblue1",
"white", "firebrick4", "white", "red1", "white", "tomato1",
"white", "blue", "white", "deepskyblue3", "white", "skyblue1",
"white", "firebrick4", "white", "red1", "white", "tomato1",
"white", "blue", "white", "deepskyblue3", "white", "skyblue1","white")) + # all the colors needed
#expand_limits(y=0) +
ylim(4, 13) +
#scale_y_continuous(breaks=0:20*4) +                          # Set tick every 4
theme(legend.justification=c(1,1),legend.position=c(1,1))    # Position legend in bottom right
FIGURE.resp_Days.15.21  <- print(FIGURE.resp_Days.15.21 + scale_colour_manual(values = c("skyblue1", "skyblue1", "deepskyblue3", "deepskyblue3",
"blue", "blue", "tomato1", "tomato1",
"red1", "red1", "firebrick4", "firebrick4")) + theme(legend.position = "none"))
# EXPERIMENTAL DESIGN KEY/SCHEMATIC FOR SMR PLOT ------------------------------------- #
schematic.data <- read.csv(file="Data/SDR_data/Experimental.design.data.csv", header=T) #read Size.info data
schematic.data
pd <- position_dodge(0)
FIG.schematic.data <- ggplot(schematic.data, aes(x=factor(x.val), y=y.val, colour=treat, group=treat, shape = treat)) +
geom_line() +
theme_bw() +
xlab("Experimental periods") +
ylab("") +
scale_colour_hue(name="treat",    # Legend label, use darker colors
breaks=c("AHAA", "AHAM", "AHMA", "AHMM",
"AHSA","AHSM", "EHAA", "EHAM",
"EHMA", "EHMM", "EHSA", "EHSM"),
labels=c("Amb-Amb-Amb", "Amb-Amb-Mod", "Amb-Mod-Amb", "Amb-Mod-Mod",
"Amb-Sev-Amb", "Amb-Sev-Mod", "Elev-Amb-Amb","Elev-Amb-Mod",
"Elev-Mod-Amb", "Elev-Mod-Mod", "Elev-Sev-Amb", "Elev-Sev-Mod"), l=40) + # Use darker colors, lightness=40
ggtitle("Experimental design schematic") +
geom_point(position = pd, shape=c(21, 21, 21, 21, 21, 21, 24, 24, 24, 24, 24, 24,
21, 21, 21, 21, 21, 21, 24, 24, 24, 24, 24, 24,
21, 21, 21, 21, 21, 21, 24, 24, 24, 24, 24, 24,
21, 21, 21, 21, 21, 21, 24, 24, 24, 24, 24, 24), size=3,
fill=c("white", "white", "white", "white", "white", "white",
"white", "white", "white", "white", "white", "white",
"white", "white", "white", "white", "white", "white",
"white", "white", "white", "white", "white", "white",
"white", "white", "white", "white", "white", "white",
"white", "white", "white", "white", "white", "white",
"white", "firebrick4", "white", "red1", "white", "tomato1",
"white", "blue", "white", "deepskyblue3", "white", "skyblue1")) +
geom_vline(xintercept = c(1.5, 2.5, 3.5), linetype="dotted",
color = "black", size=0.5) # all the colors needed
FIG.schematic.data  <- print(FIG.schematic.data +
scale_colour_manual(values = c("skyblue1", "skyblue1", "deepskyblue3", "deepskyblue3","blue", "blue", "tomato1", "tomato1",  "red1", "red1", "firebrick4", "firebrick4")) +
scale_x_discrete(labels=c("1" = "Pre", "2" = "Days 1-7","3" = "Days 8-14","4" = "Days 15-21")) +
theme(legend.position="none",panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),panel.border = element_blank(),
axis.ticks = element_blank(),axis.text.y=element_blank()) +
annotate(geom="text", x=c(1,1,2,2,2,2,2,2,3,3,3,3,3,3,4.1,4.1,4.1,4.1,4.1,4.1,4.1,4.1,4.1,4.1,4.1,4.1), y=c(9.5,3.5,
11.5,9.5,7.5,5.5,3.5,1.5,
11.5,9.5,7.5,5.5,3.5,1.5,
12.5,11.5,10.5,9.5,8.5,7.5,6.5,5.5,4.5,3.5,2.5,1.5),
label=c("EH", "AH", # PRE
"EHA","EHM","EHS","AHA","AHM","AHS", # DAYS 1 -7
"EHA","EHM","EHS","AHA","AHM","AHS", # DAYS 8 - 14
"EHAM","EHAA","EHMM","EHMA","EHSM","EHSA","AHAM","AHAA","AHMM","AHMA","AHSM","AHSA"), size =3, color="black"))
# Arrange plots
SMR.plot <- ggarrange(FIGURE.resp.pre,  FIGURE.resp_Days.1.7, FIGURE.resp_Days.8.14, FIGURE.resp_Days.15.21,ncol = 4, nrow = 1, widths = c(0.7,2,2,2), labels = c("B","C","D","E")) # combine plots
SMR.plot # view plots
SMR.plot.with.schematic <- ggarrange(FIG.schematic.data, SMR.plot,ncol = 1, nrow = 2, heights = c(1, 2.0), labels = "A") # combine plots
#gsave to Output
ggsave(file="Output/SMR.plot.pdf", SMR.plot.with.schematic, width = 12, height = 8, units = c("in")) # respiration rate plots
names(resp_Days.1.7.final)
pd <- position_dodge(0.25) # dodge between treatments to ease asthetics and interpretation
# FIGURE 1
resp_Days.pre.final$Date <- as.character(resp_Days.pre.final$Date) # call date as a character
FIGURE.resp.pre <- ggplot(resp_Days.pre.final, aes(x=factor(Date), y=resp.COUNT.µg.L.hr.indiv_mean, colour=Treatment.history, group=Treatment.history)) +
geom_errorbar(aes(ymin=resp.COUNT.µg.L.hr.indiv_mean-resp.COUNT.µg.L.hr.indiv_std.error,
ymax=resp.COUNT.µg.L.hr.indiv_mean+resp.COUNT.µg.L.hr.indiv_std.error), width=.1, position=pd) +
geom_line(position=pd) +
theme_bw() +
xlab("Date") +
ylab("SMR per individual") +
scale_colour_hue(name="Treatment",    # Legend label, use darker colors
breaks=c("AHA", "AHM", "AHS", "EHA","EHM", "EHS"),
labels=c("Amb-Amb", "Amb-Mod", "Amb-Sev", "Elev-Amb", "Elev-Mod", "Elev-Sev"), l=40) + # Use darker colors, lightness=40
ggtitle("Pre-experiment SMR") +
geom_point(position=pd, shape=c(21, 24), size=3,fill=("white")) + # 21 is filled circle
#expand_limits(y=0) +                        # Expand y range
ylim(3.5, 12.75) +
#scale_y_continuous(breaks=0:20*4) +         # Set tick every 4
theme(legend.justification=c(1,1),
legend.position=c(1,1))               # Position legend in bottom right
FIGURE.resp.pre  <- print(FIGURE.resp.pre + scale_colour_manual(values = c("skyblue1", "tomato1"))+ theme(legend.position = "none"))
# FIGURE 2
# days 1 - 7 rel metabolic rate (per individual) ----------------------------------------------------------------------------------------------- #
resp_Days.1.7.final$Date <- as.character(resp_Days.1.7.final$Date) # call date as a character
FIGURE.resp_Days.1.7 <- ggplot(resp_Days.1.7.final, aes(x=factor(Date), y=resp.COUNT.µg.L.hr.indiv_mean, group=TREATMENT, colour=TREATMENT)) +
geom_errorbar(aes(ymin=resp.COUNT.µg.L.hr.indiv_mean-resp.COUNT.µg.L.hr.indiv_std.error,
ymax=resp.COUNT.µg.L.hr.indiv_mean+resp.COUNT.µg.L.hr.indiv_std.error), width=.3, position=pd) +
geom_line(position=pd, width=.3) +
theme_bw() +
xlab("Date") +
ylab("SMR per individual") +
scale_colour_hue(name="Treatment",    # Legend label, use darker colors
breaks=c("AHA", "AHM", "AHS", "EHA","EHM", "EHS"),
labels=c("Amb-Amb", "Amb-Mod", "Amb-Sev", "Elev-Amb", "Elev-Mod", "Elev-Sev"), l=40) + # Use darker colors, lightness=40
ggtitle("Days 1-7 SMR") +
geom_point(position=pd, shape=c(21, 21, 21, 24, 24, 24,21, 21, 21, 24, 24, 24,21, 21, 21, 24, 24, 24), size=3, fill=("white")) + # 21 is filled circle
#expand_limits(y=0) +
ylim(3.5, 12.75) +
#scale_y_continuous(breaks=0:20*4) +         # Set tick every 4
theme(legend.justification=c(1,1),
legend.position=c(1,1))               # Position legend in bottom right
FIGURE.resp_Days.1.7  <- print(FIGURE.resp_Days.1.7 + scale_colour_manual(values = c("skyblue1", "deepskyblue3", "blue", "tomato1", "red1", "firebrick4"))+ theme(legend.position = "none"))
# FIGURE 3
# days 8-14 rel metabolic rate (per individual)----------------------------------------------------------------------------------------------- #
resp_Days.8.14.final$Date <- as.character(resp_Days.8.14.final$Date)
FIGURE.resp_Days.8.14 <- ggplot(resp_Days.8.14.final, aes(x=factor(Date), y=resp.COUNT.µg.L.hr.indiv_mean, colour=TREATMENT, group=TREATMENT)) +
geom_errorbar(aes(ymin=resp.COUNT.µg.L.hr.indiv_mean-resp.COUNT.µg.L.hr.indiv_std.error,
ymax=resp.COUNT.µg.L.hr.indiv_mean+resp.COUNT.µg.L.hr.indiv_std.error), width=.3, position=pd) +
geom_line(position=pd, width=.3) +
theme_bw() +
xlab("Date") +
ylab("SMR per individual") +
scale_colour_hue(name="Treatment",    # Legend label, use darker colors
breaks=c("AHA", "AHM", "AHS", "EHA","EHM", "EHS"),
labels=c("Amb-Amb", "Amb-Mod", "Amb-Sev", "Elev-Amb", "Elev-Mod", "Elev-Sev"), l=40) + # Use darker colors, lightness=40
ggtitle("Days 8-14 SMR") +
geom_point(position=pd, shape=c(21, 21, 21, 24, 24, 24,21, 21, 21, 24, 24, 24,21, 21, 21, 24, 24, 24), size=3, fill=("white")) + # 21 is filled circle
#expand_limits(y=0) +
ylim(3.5, 12.75) +
#scale_y_continuous(breaks=0:20*4) +         # Set tick every 4
theme(legend.justification=c(1,1),
legend.position=c(1,1))            # Position legend in bottom right
FIGURE.resp_Days.8.14  <- print(FIGURE.resp_Days.8.14 + scale_colour_manual(values = c("skyblue1", "deepskyblue3", "blue", "tomato1", "red1", "firebrick4"))+ theme(legend.position = "none"))
# FIGURE 4
# days 15-21 rel metabolic rate (per individual)    ----------------------------------------------------------------------------------------------- #
resp_Days.15.21.final$Date <- as.character(resp_Days.15.21.final$Date)
FIGURE.resp_Days.15.21 <- ggplot(resp_Days.15.21.final, aes(x=factor(Date), y=resp.COUNT.µg.L.hr.indiv_mean, colour=TREATMENT, group=TREATMENT, shape = Treatment.EXP_2)) +
geom_errorbar(aes(ymin=resp.COUNT.µg.L.hr.indiv_mean-resp.COUNT.µg.L.hr.indiv_std.error,
ymax=resp.COUNT.µg.L.hr.indiv_mean+resp.COUNT.µg.L.hr.indiv_std.error), width=.3, position=pd) +
geom_line(position=pd, width=.3) +
theme_bw() +
xlab("Date") +
ylab("SMR per individual") +
scale_colour_hue(name="Treatment",    # Legend label, use darker colors
breaks=c("AHAA", "AHAM", "AHMA", "AHMM",
"AHSA","AHSM", "EHAA", "EHAM",
"EHMA", "EHMM", "EHSA", "EHSM"),
labels=c("Amb-Amb-Amb", "Amb-Amb-Mod", "Amb-Mod-Amb", "Amb-Mod-Mod",
"Amb-Sev-Amb", "Amb-Sev-Mod", "Elev-Amb-Amb","Elev-Amb-Mod",
"Elev-Mod-Amb", "Elev-Mod-Mod", "Elev-Sev-Amb", "Elev-Sev-Mod"), l=40) + # Use darker colors, lightness=40
ggtitle("Days 15-21 SMR") +
geom_point(position=pd, shape=c(21, 21, 21, 21, 21, 21, 24, 24, 24, 24, 24, 24,  21, 21, 21, 21, 21, 21,
24, 24, 24, 24, 24, 24, 21, 21, 21, 21, 21, 21,  24, 24, 24, 24, 24, 24), size=3,
fill=c("firebrick4", "white", "red1", "white", "tomato1",
"white", "blue", "white", "deepskyblue3", "white", "skyblue1",
"white", "firebrick4", "white", "red1", "white", "tomato1",
"white", "blue", "white", "deepskyblue3", "white", "skyblue1",
"white", "firebrick4", "white", "red1", "white", "tomato1",
"white", "blue", "white", "deepskyblue3", "white", "skyblue1","white")) + # all the colors needed
#expand_limits(y=0) +
ylim(3.5, 12.75) +
#scale_y_continuous(breaks=0:20*4) +                          # Set tick every 4
theme(legend.justification=c(1,1),legend.position=c(1,1))    # Position legend in bottom right
FIGURE.resp_Days.15.21  <- print(FIGURE.resp_Days.15.21 + scale_colour_manual(values = c("skyblue1", "skyblue1", "deepskyblue3", "deepskyblue3",
"blue", "blue", "tomato1", "tomato1",
"red1", "red1", "firebrick4", "firebrick4")) + theme(legend.position = "none"))
# EXPERIMENTAL DESIGN KEY/SCHEMATIC FOR SMR PLOT ------------------------------------- #
schematic.data <- read.csv(file="Data/SDR_data/Experimental.design.data.csv", header=T) #read Size.info data
schematic.data
pd <- position_dodge(0)
FIG.schematic.data <- ggplot(schematic.data, aes(x=factor(x.val), y=y.val, colour=treat, group=treat, shape = treat)) +
geom_line() +
theme_bw() +
xlab("Experimental periods") +
ylab("") +
scale_colour_hue(name="treat",    # Legend label, use darker colors
breaks=c("AHAA", "AHAM", "AHMA", "AHMM",
"AHSA","AHSM", "EHAA", "EHAM",
"EHMA", "EHMM", "EHSA", "EHSM"),
labels=c("Amb-Amb-Amb", "Amb-Amb-Mod", "Amb-Mod-Amb", "Amb-Mod-Mod",
"Amb-Sev-Amb", "Amb-Sev-Mod", "Elev-Amb-Amb","Elev-Amb-Mod",
"Elev-Mod-Amb", "Elev-Mod-Mod", "Elev-Sev-Amb", "Elev-Sev-Mod"), l=40) + # Use darker colors, lightness=40
ggtitle("Experimental design schematic") +
geom_point(position = pd, shape=c(21, 21, 21, 21, 21, 21, 24, 24, 24, 24, 24, 24,
21, 21, 21, 21, 21, 21, 24, 24, 24, 24, 24, 24,
21, 21, 21, 21, 21, 21, 24, 24, 24, 24, 24, 24,
21, 21, 21, 21, 21, 21, 24, 24, 24, 24, 24, 24), size=3,
fill=c("white", "white", "white", "white", "white", "white",
"white", "white", "white", "white", "white", "white",
"white", "white", "white", "white", "white", "white",
"white", "white", "white", "white", "white", "white",
"white", "white", "white", "white", "white", "white",
"white", "white", "white", "white", "white", "white",
"white", "firebrick4", "white", "red1", "white", "tomato1",
"white", "blue", "white", "deepskyblue3", "white", "skyblue1")) +
geom_vline(xintercept = c(1.5, 2.5, 3.5), linetype="dotted",
color = "black", size=0.5) # all the colors needed
FIG.schematic.data  <- print(FIG.schematic.data +
scale_colour_manual(values = c("skyblue1", "skyblue1", "deepskyblue3", "deepskyblue3","blue", "blue", "tomato1", "tomato1",  "red1", "red1", "firebrick4", "firebrick4")) +
scale_x_discrete(labels=c("1" = "Pre", "2" = "Days 1-7","3" = "Days 8-14","4" = "Days 15-21")) +
theme(legend.position="none",panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),panel.border = element_blank(),
axis.ticks = element_blank(),axis.text.y=element_blank()) +
annotate(geom="text", x=c(1,1,2,2,2,2,2,2,3,3,3,3,3,3,4.1,4.1,4.1,4.1,4.1,4.1,4.1,4.1,4.1,4.1,4.1,4.1), y=c(9.5,3.5,
11.5,9.5,7.5,5.5,3.5,1.5,
11.5,9.5,7.5,5.5,3.5,1.5,
12.5,11.5,10.5,9.5,8.5,7.5,6.5,5.5,4.5,3.5,2.5,1.5),
label=c("EH", "AH", # PRE
"EHA","EHM","EHS","AHA","AHM","AHS", # DAYS 1 -7
"EHA","EHM","EHS","AHA","AHM","AHS", # DAYS 8 - 14
"EHAM","EHAA","EHMM","EHMA","EHSM","EHSA","AHAM","AHAA","AHMM","AHMA","AHSM","AHSA"), size =3, color="black"))
# Arrange plots
SMR.plot <- ggarrange(FIGURE.resp.pre,  FIGURE.resp_Days.1.7, FIGURE.resp_Days.8.14, FIGURE.resp_Days.15.21,ncol = 4, nrow = 1, widths = c(0.7,2,2,2), labels = c("B","C","D","E")) # combine plots
SMR.plot # view plots
SMR.plot.with.schematic <- ggarrange(FIG.schematic.data, SMR.plot,ncol = 1, nrow = 2, heights = c(1, 2.0), labels = "A") # combine plots
#gsave to Output
ggsave(file="Output/SMR.plot.pdf", SMR.plot.with.schematic, width = 12, height = 8, units = c("in")) # respiration rate plots
##################################################### #
names(resp_Days.1.7.final)
pd <- position_dodge(0.25) # dodge between treatments to ease asthetics and interpretation
# FIGURE 1
resp_Days.pre.final$Date <- as.character(resp_Days.pre.final$Date) # call date as a character
FIGURE.resp.pre <- ggplot(resp_Days.pre.final, aes(x=factor(Date), y=resp.COUNT.µg.L.hr.indiv_mean, colour=Treatment.history, group=Treatment.history)) +
geom_errorbar(aes(ymin=resp.COUNT.µg.L.hr.indiv_mean-resp.COUNT.µg.L.hr.indiv_std.error,
ymax=resp.COUNT.µg.L.hr.indiv_mean+resp.COUNT.µg.L.hr.indiv_std.error), width=.1, position=pd) +
geom_line(position=pd) +
theme_bw() +
xlab("Date") +
ylab("SMR per individual") +
scale_colour_hue(name="Treatment",    # Legend label, use darker colors
breaks=c("AHA", "AHM", "AHS", "EHA","EHM", "EHS"),
labels=c("Amb-Amb", "Amb-Mod", "Amb-Sev", "Elev-Amb", "Elev-Mod", "Elev-Sev"), l=40) + # Use darker colors, lightness=40
ggtitle("Pre-experiment SMR") +
geom_point(position=pd, shape=c(21, 24), size=3,fill=("white")) + # 21 is filled circle
#expand_limits(y=0) +                        # Expand y range
ylim(3.5, 13) +
#scale_y_continuous(breaks=0:20*4) +         # Set tick every 4
theme(legend.justification=c(1,1),
legend.position=c(1,1))               # Position legend in bottom right
FIGURE.resp.pre  <- print(FIGURE.resp.pre + scale_colour_manual(values = c("skyblue1", "tomato1"))+ theme(legend.position = "none"))
# FIGURE 2
# days 1 - 7 rel metabolic rate (per individual) ----------------------------------------------------------------------------------------------- #
resp_Days.1.7.final$Date <- as.character(resp_Days.1.7.final$Date) # call date as a character
FIGURE.resp_Days.1.7 <- ggplot(resp_Days.1.7.final, aes(x=factor(Date), y=resp.COUNT.µg.L.hr.indiv_mean, group=TREATMENT, colour=TREATMENT)) +
geom_errorbar(aes(ymin=resp.COUNT.µg.L.hr.indiv_mean-resp.COUNT.µg.L.hr.indiv_std.error,
ymax=resp.COUNT.µg.L.hr.indiv_mean+resp.COUNT.µg.L.hr.indiv_std.error), width=.3, position=pd) +
geom_line(position=pd, width=.3) +
theme_bw() +
xlab("Date") +
ylab("SMR per individual") +
scale_colour_hue(name="Treatment",    # Legend label, use darker colors
breaks=c("AHA", "AHM", "AHS", "EHA","EHM", "EHS"),
labels=c("Amb-Amb", "Amb-Mod", "Amb-Sev", "Elev-Amb", "Elev-Mod", "Elev-Sev"), l=40) + # Use darker colors, lightness=40
ggtitle("Days 1-7 SMR") +
geom_point(position=pd, shape=c(21, 21, 21, 24, 24, 24,21, 21, 21, 24, 24, 24,21, 21, 21, 24, 24, 24), size=3, fill=("white")) + # 21 is filled circle
#expand_limits(y=0) +
ylim(3.5, 13) +
#scale_y_continuous(breaks=0:20*4) +         # Set tick every 4
theme(legend.justification=c(1,1),
legend.position=c(1,1))               # Position legend in bottom right
FIGURE.resp_Days.1.7  <- print(FIGURE.resp_Days.1.7 + scale_colour_manual(values = c("skyblue1", "deepskyblue3", "blue", "tomato1", "red1", "firebrick4"))+ theme(legend.position = "none"))
# FIGURE 3
# days 8-14 rel metabolic rate (per individual)----------------------------------------------------------------------------------------------- #
resp_Days.8.14.final$Date <- as.character(resp_Days.8.14.final$Date)
FIGURE.resp_Days.8.14 <- ggplot(resp_Days.8.14.final, aes(x=factor(Date), y=resp.COUNT.µg.L.hr.indiv_mean, colour=TREATMENT, group=TREATMENT)) +
geom_errorbar(aes(ymin=resp.COUNT.µg.L.hr.indiv_mean-resp.COUNT.µg.L.hr.indiv_std.error,
ymax=resp.COUNT.µg.L.hr.indiv_mean+resp.COUNT.µg.L.hr.indiv_std.error), width=.3, position=pd) +
geom_line(position=pd, width=.3) +
theme_bw() +
xlab("Date") +
ylab("SMR per individual") +
scale_colour_hue(name="Treatment",    # Legend label, use darker colors
breaks=c("AHA", "AHM", "AHS", "EHA","EHM", "EHS"),
labels=c("Amb-Amb", "Amb-Mod", "Amb-Sev", "Elev-Amb", "Elev-Mod", "Elev-Sev"), l=40) + # Use darker colors, lightness=40
ggtitle("Days 8-14 SMR") +
geom_point(position=pd, shape=c(21, 21, 21, 24, 24, 24,21, 21, 21, 24, 24, 24,21, 21, 21, 24, 24, 24), size=3, fill=("white")) + # 21 is filled circle
#expand_limits(y=0) +
ylim(3.5, 13) +
#scale_y_continuous(breaks=0:20*4) +         # Set tick every 4
theme(legend.justification=c(1,1),
legend.position=c(1,1))            # Position legend in bottom right
FIGURE.resp_Days.8.14  <- print(FIGURE.resp_Days.8.14 + scale_colour_manual(values = c("skyblue1", "deepskyblue3", "blue", "tomato1", "red1", "firebrick4"))+ theme(legend.position = "none"))
# FIGURE 4
# days 15-21 rel metabolic rate (per individual)    ----------------------------------------------------------------------------------------------- #
resp_Days.15.21.final$Date <- as.character(resp_Days.15.21.final$Date)
FIGURE.resp_Days.15.21 <- ggplot(resp_Days.15.21.final, aes(x=factor(Date), y=resp.COUNT.µg.L.hr.indiv_mean, colour=TREATMENT, group=TREATMENT, shape = Treatment.EXP_2)) +
geom_errorbar(aes(ymin=resp.COUNT.µg.L.hr.indiv_mean-resp.COUNT.µg.L.hr.indiv_std.error,
ymax=resp.COUNT.µg.L.hr.indiv_mean+resp.COUNT.µg.L.hr.indiv_std.error), width=.3, position=pd) +
geom_line(position=pd, width=.3) +
theme_bw() +
xlab("Date") +
ylab("SMR per individual") +
scale_colour_hue(name="Treatment",    # Legend label, use darker colors
breaks=c("AHAA", "AHAM", "AHMA", "AHMM",
"AHSA","AHSM", "EHAA", "EHAM",
"EHMA", "EHMM", "EHSA", "EHSM"),
labels=c("Amb-Amb-Amb", "Amb-Amb-Mod", "Amb-Mod-Amb", "Amb-Mod-Mod",
"Amb-Sev-Amb", "Amb-Sev-Mod", "Elev-Amb-Amb","Elev-Amb-Mod",
"Elev-Mod-Amb", "Elev-Mod-Mod", "Elev-Sev-Amb", "Elev-Sev-Mod"), l=40) + # Use darker colors, lightness=40
ggtitle("Days 15-21 SMR") +
geom_point(position=pd, shape=c(21, 21, 21, 21, 21, 21, 24, 24, 24, 24, 24, 24,  21, 21, 21, 21, 21, 21,
24, 24, 24, 24, 24, 24, 21, 21, 21, 21, 21, 21,  24, 24, 24, 24, 24, 24), size=3,
fill=c("firebrick4", "white", "red1", "white", "tomato1",
"white", "blue", "white", "deepskyblue3", "white", "skyblue1",
"white", "firebrick4", "white", "red1", "white", "tomato1",
"white", "blue", "white", "deepskyblue3", "white", "skyblue1",
"white", "firebrick4", "white", "red1", "white", "tomato1",
"white", "blue", "white", "deepskyblue3", "white", "skyblue1","white")) + # all the colors needed
#expand_limits(y=0) +
ylim(3.5, 13) +
#scale_y_continuous(breaks=0:20*4) +                          # Set tick every 4
theme(legend.justification=c(1,1),legend.position=c(1,1))    # Position legend in bottom right
FIGURE.resp_Days.15.21  <- print(FIGURE.resp_Days.15.21 + scale_colour_manual(values = c("skyblue1", "skyblue1", "deepskyblue3", "deepskyblue3",
"blue", "blue", "tomato1", "tomato1",
"red1", "red1", "firebrick4", "firebrick4")) + theme(legend.position = "none"))
# EXPERIMENTAL DESIGN KEY/SCHEMATIC FOR SMR PLOT ------------------------------------- #
schematic.data <- read.csv(file="Data/SDR_data/Experimental.design.data.csv", header=T) #read Size.info data
schematic.data
pd <- position_dodge(0)
FIG.schematic.data <- ggplot(schematic.data, aes(x=factor(x.val), y=y.val, colour=treat, group=treat, shape = treat)) +
geom_line() +
theme_bw() +
xlab("Experimental periods") +
ylab("") +
scale_colour_hue(name="treat",    # Legend label, use darker colors
breaks=c("AHAA", "AHAM", "AHMA", "AHMM",
"AHSA","AHSM", "EHAA", "EHAM",
"EHMA", "EHMM", "EHSA", "EHSM"),
labels=c("Amb-Amb-Amb", "Amb-Amb-Mod", "Amb-Mod-Amb", "Amb-Mod-Mod",
"Amb-Sev-Amb", "Amb-Sev-Mod", "Elev-Amb-Amb","Elev-Amb-Mod",
"Elev-Mod-Amb", "Elev-Mod-Mod", "Elev-Sev-Amb", "Elev-Sev-Mod"), l=40) + # Use darker colors, lightness=40
ggtitle("Experimental design schematic") +
geom_point(position = pd, shape=c(21, 21, 21, 21, 21, 21, 24, 24, 24, 24, 24, 24,
21, 21, 21, 21, 21, 21, 24, 24, 24, 24, 24, 24,
21, 21, 21, 21, 21, 21, 24, 24, 24, 24, 24, 24,
21, 21, 21, 21, 21, 21, 24, 24, 24, 24, 24, 24), size=3,
fill=c("white", "white", "white", "white", "white", "white",
"white", "white", "white", "white", "white", "white",
"white", "white", "white", "white", "white", "white",
"white", "white", "white", "white", "white", "white",
"white", "white", "white", "white", "white", "white",
"white", "white", "white", "white", "white", "white",
"white", "firebrick4", "white", "red1", "white", "tomato1",
"white", "blue", "white", "deepskyblue3", "white", "skyblue1")) +
geom_vline(xintercept = c(1.5, 2.5, 3.5), linetype="dotted",
color = "black", size=0.5) # all the colors needed
FIG.schematic.data  <- print(FIG.schematic.data +
scale_colour_manual(values = c("skyblue1", "skyblue1", "deepskyblue3", "deepskyblue3","blue", "blue", "tomato1", "tomato1",  "red1", "red1", "firebrick4", "firebrick4")) +
scale_x_discrete(labels=c("1" = "Pre", "2" = "Days 1-7","3" = "Days 8-14","4" = "Days 15-21")) +
theme(legend.position="none",panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),panel.border = element_blank(),
axis.ticks = element_blank(),axis.text.y=element_blank()) +
annotate(geom="text", x=c(1,1,2,2,2,2,2,2,3,3,3,3,3,3,4.1,4.1,4.1,4.1,4.1,4.1,4.1,4.1,4.1,4.1,4.1,4.1), y=c(9.5,3.5,
11.5,9.5,7.5,5.5,3.5,1.5,
11.5,9.5,7.5,5.5,3.5,1.5,
12.5,11.5,10.5,9.5,8.5,7.5,6.5,5.5,4.5,3.5,2.5,1.5),
label=c("EH", "AH", # PRE
"EHA","EHM","EHS","AHA","AHM","AHS", # DAYS 1 -7
"EHA","EHM","EHS","AHA","AHM","AHS", # DAYS 8 - 14
"EHAM","EHAA","EHMM","EHMA","EHSM","EHSA","AHAM","AHAA","AHMM","AHMA","AHSM","AHSA"), size =3, color="black"))
# Arrange plots
SMR.plot <- ggarrange(FIGURE.resp.pre,  FIGURE.resp_Days.1.7, FIGURE.resp_Days.8.14, FIGURE.resp_Days.15.21,ncol = 4, nrow = 1, widths = c(0.7,2,2,2), labels = c("B","C","D","E")) # combine plots
SMR.plot # view plots
SMR.plot.with.schematic <- ggarrange(FIG.schematic.data, SMR.plot,ncol = 1, nrow = 2, heights = c(1, 2.0), labels = "A") # combine plots
#gsave to Output
ggsave(file="Output/SMR.plot.pdf", SMR.plot.with.schematic, width = 12, height = 8, units = c("in")) # respiration rate plots
